<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T&C Buddy</title>
    <link rel="stylesheet" href="tailwind.css" />
  </head>
  <body class="bg-slate-100">
    <div class="p-4 space-y-4">
      <header class="bg-white rounded-xl shadow-sm p-4 flex items-center justify-between">
        <div>
          <h1 class="text-lg font-bold text-slate-900">T&amp;C Buddy ü§ù</h1>
          <p class="text-sm text-slate-500 leading-snug">Understand Terms &amp; Conditions in seconds.</p>
        </div>
        <div id="riskBadge" class="badge bg-slate-100 text-slate-500">Ready</div>
      </header>

      <section class="bg-white rounded-xl shadow-sm p-4 space-y-3">
        <div class="flex items-center justify-between">
          <label class="text-sm font-medium text-slate-700" for="processToggle">Process locally</label>
          <div id="processToggle" class="toggle" role="switch" aria-checked="false" tabindex="0">
            <div class="toggle-thumb"></div>
          </div>
        </div>
        <p class="text-xs text-slate-500">
          Local mode scans text with quick heuristics when you prefer to skip sending data to the cloud.
        </p>
      </section>

      <section class="bg-white rounded-xl shadow-sm p-4 space-y-3">
        <button id="analyzeBtn" class="btn-primary w-full">Analyze this page</button>
        <button id="retryBtn" class="btn-secondary w-full hidden">Retry</button>
        <div id="loadingState" class="flex items-center justify-center gap-2 hidden">
          <div class="spinner" role="status" aria-label="Analyzing"></div>
          <span class="text-sm text-slate-600">Generating summary‚Ä¶</span>
        </div>
        <p class="text-xs text-slate-500 text-center">
          No personal info sent. Summaries may be approximate. ‚ö†Ô∏è This is not legal advice.
        </p>
      </section>

      <section id="summarySection" class="bg-white rounded-xl shadow-sm p-4 space-y-4 hidden">
        <div>
          <h2 class="text-base font-semibold text-slate-800">TL;DR</h2>
          <p id="tldr" class="text-sm text-slate-700 leading-snug mt-2"></p>
        </div>

        <div>
          <div class="flex items-center justify-between mb-2">
            <h3 class="text-sm font-semibold text-slate-800">Key Points</h3>
            <span id="summarySource" class="text-xs text-slate-400"></span>
          </div>
          <ul id="bullets" class="space-y-2 text-sm text-slate-700 leading-snug min-h-120"></ul>
        </div>

        <div>
          <h3 class="text-sm font-semibold text-slate-800 mb-2">Red Flags</h3>
          <div class="grid grid-cols-2 gap-3 max-h-48 overflow-y-auto" id="redFlags"></div>
        </div>

        <button id="copyBtn" class="btn-secondary w-full">Copy Support Message</button>
      </section>

      <section class="bg-white rounded-xl shadow-sm p-4 space-y-3">
        <h3 class="text-sm font-semibold text-slate-800">Deepseek API Key</h3>
        <label class="text-xs text-slate-500" for="apiKeyInput">Stored securely in your browser.</label>
        <input
          id="apiKeyInput"
          type="password"
          placeholder="sk-..."
          class="w-full px-3 py-2 rounded-md border border-slate-200 text-sm"
        />
        <div class="flex gap-2">
          <button id="saveKeyBtn" class="btn-secondary w-full">Save Key</button>
          <button id="toggleKeyVisibility" class="btn-secondary w-full">Show</button>
        </div>
        <span id="keyStatus" class="text-xs text-slate-500"></span>
      </section>

      <footer class="text-xs text-slate-400 text-center">
        Built for consumers. ‚ö†Ô∏è This is not legal advice.
      </footer>
    </div>

    <script type="module" src="popup.js"></script>
  </body>
</html>
